extends templates/layout

block content
  .container
    #listing.row
      table.table.table-reponsive.table-striped
        thead
          tr
            th Name
            th Host
            th Sessions
            th Description
            th 
        tbody
          if workshops
            for workshop in workshops
              tr
                td= workshop.name
                td= workshop.host
                td
                  for session in workshop.sessions
                    if session.capacity == session._registered.length
                      //- Full?
                      .label.label-default= session.session
                      |  
                    else if session.capacity * .66 <= session._registered.length
                      //- 2/3's full?
                      .label.label-danger= session.session
                      |  
                    else if session.capacity * .5 <= session._registered.length
                      //- Half hull?
                      .label.label-warning= session.session
                      |  
                    else 
                      .label.label-success= session.session
                      |  
                if workshop.description.length > 120
                  td= workshop.description.substr(0,120) + "..."
                else
                  td= workshop.description
                td
                  a.btn.btn-sm.btn-info(href="/workshop/#{workshop._id}")
                    i.icon-info
                    |  Info 

    #query.row
      form.form-horizontal
        .form-group.col-sm-5
          label Find: (In description)
          input.form-control(type="text", name="query", placeholder="(Optional) Enter a query here. For example 'basket'")
        .col-sm-2
        .form-group.col-sm-5
          label Sessions: (Comma seperate)
          input.form-control(type="text", name="sessions", placeholder="(Optional) Comma seperated list of sessions. Eg. 1,2,3")
        .form-group
          button.btn.btn-primary.btn-block(type="submit")
            i.icon-search
            |  Search
          if session.isAdmin
            a.btn.btn-info.btn-block(data-toggle="collapse", href="#admin") 
              i.icon-plus
              |  Add Workshop


    if session.isAdmin
      .panel-group
        .panel.row
          #admin.collapse
            form.form-horizontal(action="/workshop", method="POST")
              fieldset
                legend Workshop Details
                .control-group
                  label Name
                  input.form-control(type="text", name="name", placeholder="Bear Wrangling", required)
                .control-group
                  label Host
                  input.form-control(type="text", name="host", placeholder="Mr. Foo", required)
                .control-group
                  label Description
                  textarea.form-control(rows=3, name="description", placeholder="Wrangle Bears with Mr. Foo on the roof of the Hyatt.", required)
                .control-group
                  label Allows
                  select.form-control(name="allows", required)
                    option(value="") Please choose...
                    option(value="default") Default (Youth, Young Adults, Young Chaperones)
                    option(value="all") All Allowed (Including Chaperones)
                    option(value="chaperones") Only Chaperones, Young Chaperones.
                    option(value="youth") Only Youth, Young Adults.

              br
              fieldset
                legend Sessions Available
                .container
                for session in [1,2,3,4,5,6,7,8,9,10,11,12]
                  .col-sm-4
                    h4 Session #{session}
                    //- Basically, we make an array of each variable. The server parses it to the proper format.
                    .radio
                      label Enabled
                        input(type="radio", name="enabled[#{session}]", value="on")
                    .radio
                      label Disabled
                        input(type="radio", name="enabled[#{session}]", value="off", checked)
                    .control-group
                      label Room
                      input.form-control(type="text", name="room[#{session}]", placeholder="The Roof")
                    .control-group
                      label Venue
                      input.form-control(type="text", name="venue[#{session}]", placeholder="Hyatt Regency")
                    .control-group
                      label Capacity
                      input.form-control(type="number", name="capacity[#{session}]", placeholder="55")
              br
              button.btn.btn-primary.btn-block(type="submit")
                i.icon-edit
                |  Update Details